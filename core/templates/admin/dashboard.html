{% extends "admin/base_admin.html" %}
{% load static %}

{% block title %}Dashboard - Admin{% endblock %}

{% block extra_css %}
<style>
  /* Panel backgrounds */
  .panel-card {
    border-radius: .5rem;
  }

  /* Upcoming appointments background (image + overlay) */
  .appts-bg {
    position: relative;
    background-image: url('{% static "images/dashboard-bg.png" %}');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    overflow: hidden;
  }
  .appts-bg::before {
    /* soft overlay to improve text contrast */
    content: "";
    position: absolute; inset: 0;
    background: rgba(0,0,0,.18);
  }
  .appts-content {
    position: relative; /* sit above overlay */
  }

  /* List items: sharp corners + slight transparency */
  .appt-item {
    border-radius: 0;
    background-color: rgba(255,255,255,0.85);
  }

  /* Scroll area */
  .scroll-y {
    overflow-y: auto;
  }
</style>
{% endblock %}

{% block content %}
<!-- Welcome Banner -->
<div class="p-3 mb-3 panel-card" style="background-color:#e8f2f0;">
  <h1 class="fw-normal m-0" style="font-family: serif; font-size: clamp(1.75rem, 2.5vw + 1rem, 3rem);">
    Welcome to your Dashboard {{ user.first_name }}!
  </h1>
</div>

<!-- Layout -->
<div class="container-fluid">
  <div class="row g-4">

    <!-- Calendar API -->
    <div class="col-12 col-lg-7">
      <div class="panel-card shadow p-4" style="background-color:#C3D5D6; min-height: 28rem;">
        <strong>Calendar API</strong> coming soon‚Ä¶
      </div>
    </div>

    <!-- Upcoming Appointments -->
    <div class="col-12 col-lg-5">
      <section class="panel-card shadow appts-bg" role="region" aria-label="Upcoming appointments">
        <div class="appts-content d-flex flex-column" style="min-height: 32rem; background-color: #115a5c98;" >

          <!-- Header -->
          <div class="px-3 py-2" style="background: rgba(0,0,0,0.08);">
            <h5 class="m-0 text-white">Upcoming Appointments</h5>
            <small class="text-light">Next 3</small>
          </div>

          <!-- List -->
          <div class="scroll-y px-3 py-2" style="max-height: 28rem;">
            {% if upcoming_appts %}
              <ul class="list-unstyled m-0">
                {% for appt in upcoming_appts %}
                  <li class="mb-3 p-2 shadow-sm appt-item">
                    <div class="d-flex justify-content-between align-items-start">
                      <div>
                        <div class="fw-semibold">
                          {{ appt.start_time|date:"D, M j, Y" }}
                        </div>
                        <div class="text-muted">
                          {{ appt.start_time|date:"g:i A" }}
                        </div>
                        <div class="text-muted small">
                          üìç <em>In Office ‚Äì In Person</em>
                        </div>
                      </div>
                      <span class="badge bg-primary">{{ appt.get_status_display }}</span>
                    </div>

                    {% if appt.comments %}
                      <div class="mt-2 small text-muted">
                        {{ appt.comments }}
                      </div>
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>
            {% else %}
              <p class="text-white-50 m-0">You have no upcoming appointments.</p>
            {% endif %}
          </div>

        </div>
      </section>
    </div>

  </div>
</div>
{% endblock %}
